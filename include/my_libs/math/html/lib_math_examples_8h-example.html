<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>lib_math: lib_math_examples.h</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">lib_math
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle"><div class="title">lib_math_examples.h</div></div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;cmath&gt;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="lib__math_8h.html">lib_math.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">double</span> sqrt_of_2(<span class="keywordtype">double</span> x)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">return</span> (2 - std::pow(x, 2));</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main()</div>
<div class="line">{</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// ROUND</span></div>
<div class="line">    {</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;ROUND&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        <span class="keywordtype">double</span> pi = 3.141592653589793238462643383279502884197;</div>
<div class="line">        std::cout &lt;&lt; std::to_string(pi) &lt;&lt; <span class="stringliteral">&quot; -&gt; &quot;</span> &lt;&lt; std::to_string(<a id="a0" name="a0"></a>lib_math::round(pi, 2));</div>
<div class="line">        std::cout &lt;&lt; <span class="charliteral">&#39;\n&#39;</span> &lt;&lt; std::endl;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// LINEAR INTERPOLATION</span></div>
<div class="line">    {</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;LINEAR INTERPOLATION&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordtype">bool</span> extrapolate = <span class="keyword">true</span>;</div>
<div class="line">        std::vector&lt;double&gt; x = {0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0, 1.1, 1.2, 1.3, 1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2.0};</div>
<div class="line">        std::vector&lt;double&gt; y = {-2.30258509, -1.60943791, -1.20397280, -0.91629073, -0.69314718, -0.51082562, -0.35667494, -0.22314355, -0.10536052, 0.00000000,</div>
<div class="line">                                  0.09531018,  0.18232156,  0.26236426,  0.33647224,  0.40546511,  0.47000363,  0.53062825,  0.58778666,  0.64185389, 0.69314718};</div>
<div class="line">        std::vector&lt;double&gt; X = {0.09, 0.15, 0.25, 2.10};</div>
<div class="line">        std::vector&lt;double&gt; Y = <a id="a1" name="a1"></a><a class="code hl_function" href="lib__math_8h.html#a4a03f44347bf4fd18e6f5a45483b843f">lib_math::lin_interp1d</a>(x, y, X, extrapolate);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (std::size_t idx = 0; idx &lt; X.size(); idx++)</div>
<div class="line">        {</div>
<div class="line">            std::cout &lt;&lt; <span class="stringliteral">&quot;exact:         ln(&quot;</span> &lt;&lt; std::to_string(X[idx]) &lt;&lt; <span class="stringliteral">&quot;) =  &quot;</span> &lt;&lt; std::to_string(std::log(X[idx])) &lt;&lt; std::endl;</div>
<div class="line">            std::cout &lt;&lt; <span class="stringliteral">&quot;interpolation: ln(&quot;</span> &lt;&lt; std::to_string(X[idx]) &lt;&lt; <span class="stringliteral">&quot;) =&gt; &quot;</span> &lt;&lt; std::to_string(Y[idx]) &lt;&lt; std::endl;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        std::cout &lt;&lt; <span class="charliteral">&#39;\n&#39;</span> &lt;&lt; std::endl;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// NORMAL DISTRIBUTION</span></div>
<div class="line">    {</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;NORMAL DISTRIBUTION&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">        std::vector&lt;double&gt; x = {-4.0, -3.0, -2.0, -1.0, 0.0, 1.0, 2.0, 3.0, 4.0};</div>
<div class="line">        std::vector&lt;double&gt; pdf = <a id="a2" name="a2"></a><a class="code hl_function" href="lib__math_8h.html#acf0f859fcd73d3d6ed62b3bd85dd3292">lib_math::norm_pdf</a>(x);</div>
<div class="line">        std::vector&lt;double&gt; cdf = <a id="a3" name="a3"></a><a class="code hl_function" href="lib__math_8h.html#a7798bd15f5cd4340360e44ed568c9044">lib_math::norm_cdf</a>(x);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> idx = 0; idx &lt; x.size(); idx++)</div>
<div class="line">        {</div>
<div class="line">            std::cout &lt;&lt; <span class="stringliteral">&quot;x: &quot;</span> &lt;&lt; std::to_string(x[idx]) &lt;&lt; <span class="stringliteral">&quot; -&gt; pdf: &quot;</span> &lt;&lt; std::to_string(pdf[idx]) &lt;&lt; <span class="stringliteral">&quot;, cdf: &quot;</span> &lt;&lt; std::to_string(cdf[idx]) &lt;&lt; std::endl;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        std::vector&lt;double&gt; q = {0.001, 0.01, 0.10, 0.25, 0.50, 0.75, 0.90, 0.99, 0.999};</div>
<div class="line">        std::vector&lt;double&gt; z = <a id="a4" name="a4"></a><a class="code hl_function" href="lib__math_8h.html#a6a9d2dd0b82c9d95e93ed70d58db615c">lib_math::norm_inv</a>(q);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> idx = 0; idx &lt; q.size(); idx++)</div>
<div class="line">        {</div>
<div class="line">            std::cout &lt;&lt; <span class="stringliteral">&quot;q: &quot;</span> &lt;&lt; std::to_string(q[idx]) &lt;&lt; <span class="stringliteral">&quot; -&gt; inv: &quot;</span> &lt;&lt; std::to_string(z[idx])&lt;&lt; std::endl;</div>
<div class="line">        }</div>
<div class="line">        std::cout &lt;&lt; <span class="charliteral">&#39;\n&#39;</span> &lt;&lt; std::endl;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// NEWTON-RAPHSON METHOD</span></div>
<div class="line">    {</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;NEWTON-RAPHSON METHOD&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordtype">double</span> X = 1.5;  <span class="comment">// initial estimate of square root of 2</span></div>
<div class="line">        <span class="keywordtype">double</span> step = 1e-5;</div>
<div class="line">        <span class="keywordtype">double</span> tolerance = 1e-7;</div>
<div class="line">        <span class="keywordtype">int</span> iter_max = 1000;</div>
<div class="line"> </div>
<div class="line">        <a id="_a5" name="_a5"></a><a class="code hl_struct" href="structlib__math_1_1newton__raphson__res.html">lib_math::newton_raphson_res</a> res = <a id="a6" name="a6"></a><a class="code hl_function" href="lib__math_8h.html#a0af3762a51ff511f2e2341d13f63c509">lib_math::newton_raphson</a>(sqrt_of_2, X, step, tolerance, iter_max);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (res.<a id="a7" name="a7"></a>success)</div>
<div class="line">            std::cout &lt;&lt; <span class="stringliteral">&quot;Newton-Raphson method: success&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">            std::cout &lt;&lt; <span class="stringliteral">&quot;Newton-Raphson method: failure&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;square root of 2 is &quot;</span> &lt;&lt; std::to_string(res.<a id="a8" name="a8"></a>x) &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;step: &quot;</span> &lt;&lt; std::to_string(res.<a id="a9" name="a9"></a>step) &lt;&lt; <span class="stringliteral">&quot;; tolerance: &quot;</span> &lt;&lt; std::to_string(res.<a id="a10" name="a10"></a>tolerance) &lt;&lt; <span class="stringliteral">&quot;; iter_no: &quot;</span> &lt;&lt; std::to_string(res.<a id="a11" name="a11"></a>iter_no) &lt;&lt; <span class="stringliteral">&quot;; iter_max: &quot;</span> &lt;&lt; std::to_string(res.<a id="a12" name="a12"></a>iter_max) &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;msg: &quot;</span> &lt;&lt; res.<a id="a13" name="a13"></a>msg &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; <span class="charliteral">&#39;\n&#39;</span> &lt;&lt; std::endl;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// EMPIRICAL PROBABILITY DISTRIBUTION</span></div>
<div class="line">    {</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;EMPIRICAL PROBABILITY DISTRIBUTION&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// cumulative normal distribution</span></div>
<div class="line">        <a id="_a14" name="_a14"></a><a class="code hl_class" href="classlib__math_1_1myDiscProbDist.html">lib_math::myDiscProbDist</a> cdf = <a class="code hl_class" href="classlib__math_1_1myDiscProbDist.html">lib_math::myDiscProbDist</a>(<span class="stringliteral">&quot;include/my_libs/math/data/lib_math/norm_cdf.csv&quot;</span>);</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;norm_cdf(-0.25) = &quot;</span> &lt;&lt; cdf.<a id="a15" name="a15"></a><a class="code hl_function" href="classlib__math_1_1myDiscProbDist.html#ae053160e221ed58270c24c89dde6507d">get</a>(-0.25) &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// inverse normal distribution</span></div>
<div class="line">        <a class="code hl_class" href="classlib__math_1_1myDiscProbDist.html">lib_math::myDiscProbDist</a> inv = <a class="code hl_class" href="classlib__math_1_1myDiscProbDist.html">lib_math::myDiscProbDist</a>(<span class="stringliteral">&quot;include/my_libs/math/data/lib_math/norm_inv.csv&quot;</span>);</div>
<div class="line">        std::vector&lt;double&gt; x = {0.01, 0.10, 0.50, 0.90, 0.95, 0.99};</div>
<div class="line">        std::vector&lt;double&gt; y = inv.<a class="code hl_function" href="classlib__math_1_1myDiscProbDist.html#ae053160e221ed58270c24c89dde6507d">get</a>(x);</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; x.size(); i++)</div>
<div class="line">            std::cout &lt;&lt; <span class="stringliteral">&quot;norm_inv(&quot;</span> &lt;&lt; x[i] &lt;&lt; <span class="stringliteral">&quot;) = &quot;</span> &lt;&lt; y[i] &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; <span class="charliteral">&#39;\n&#39;</span> &lt;&lt; std::endl;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="ttc" id="aclasslib__math_1_1myDiscProbDist_html"><div class="ttname"><a href="classlib__math_1_1myDiscProbDist.html">lib_math::myDiscProbDist</a></div><div class="ttdoc">Discrete probability distribution.</div><div class="ttdef"><b>Definition:</b> lib_math.h:120</div></div>
<div class="ttc" id="aclasslib__math_1_1myDiscProbDist_html_ae053160e221ed58270c24c89dde6507d"><div class="ttname"><a href="classlib__math_1_1myDiscProbDist.html#ae053160e221ed58270c24c89dde6507d">lib_math::myDiscProbDist::get</a></div><div class="ttdeci">double get(const double &amp;x)</div><div class="ttdoc">Get f(x) for a single point x.</div><div class="ttdef"><b>Definition:</b> lib_math.cpp:320</div></div>
<div class="ttc" id="alib__math_8h_html"><div class="ttname"><a href="lib__math_8h.html">lib_math.h</a></div></div>
<div class="ttc" id="alib__math_8h_html_a0af3762a51ff511f2e2341d13f63c509"><div class="ttname"><a href="lib__math_8h.html#a0af3762a51ff511f2e2341d13f63c509">lib_math::newton_raphson</a></div><div class="ttdeci">newton_raphson_res newton_raphson(double(*func)(double), double x, const double &amp;step, const double &amp;tolerance, const unsigned short &amp;iter_max)</div><div class="ttdoc">Implementation of Newton-Raphson method.</div><div class="ttdef"><b>Definition:</b> lib_math.cpp:202</div></div>
<div class="ttc" id="alib__math_8h_html_a4a03f44347bf4fd18e6f5a45483b843f"><div class="ttname"><a href="lib__math_8h.html#a4a03f44347bf4fd18e6f5a45483b843f">lib_math::lin_interp1d</a></div><div class="ttdeci">std::vector&lt; double &gt; lin_interp1d(const std::vector&lt; double &gt; &amp;x, const std::vector&lt; double &gt; &amp;y, const std::vector&lt; double &gt; &amp;X, const bool extrapolate=false)</div><div class="ttdoc">Linear 1D interpolation.</div><div class="ttdef"><b>Definition:</b> lib_math.cpp:26</div></div>
<div class="ttc" id="alib__math_8h_html_a6a9d2dd0b82c9d95e93ed70d58db615c"><div class="ttname"><a href="lib__math_8h.html#a6a9d2dd0b82c9d95e93ed70d58db615c">lib_math::norm_inv</a></div><div class="ttdeci">double norm_inv(const double &amp;x)</div><div class="ttdoc">Inverse standardized normal distribution evaluated at a single quantile.</div><div class="ttdef"><b>Definition:</b> lib_math.cpp:128</div></div>
<div class="ttc" id="alib__math_8h_html_a7798bd15f5cd4340360e44ed568c9044"><div class="ttname"><a href="lib__math_8h.html#a7798bd15f5cd4340360e44ed568c9044">lib_math::norm_cdf</a></div><div class="ttdeci">double norm_cdf(const double &amp;x)</div><div class="ttdoc">Standardized normal CDF evaluated at a single point.</div><div class="ttdef"><b>Definition:</b> lib_math.cpp:113</div></div>
<div class="ttc" id="alib__math_8h_html_acf0f859fcd73d3d6ed62b3bd85dd3292"><div class="ttname"><a href="lib__math_8h.html#acf0f859fcd73d3d6ed62b3bd85dd3292">lib_math::norm_pdf</a></div><div class="ttdeci">double norm_pdf(const double &amp;x)</div><div class="ttdoc">Standaridized normal PDF evaluated at a single point.</div><div class="ttdef"><b>Definition:</b> lib_math.cpp:120</div></div>
<div class="ttc" id="astructlib__math_1_1newton__raphson__res_html"><div class="ttname"><a href="structlib__math_1_1newton__raphson__res.html">lib_math::newton_raphson_res</a></div><div class="ttdoc">Data structure holding results of Newton-Raphson method.</div><div class="ttdef"><b>Definition:</b> lib_math.h:92</div></div>
</div><!-- fragment --> </div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4
</small></address>
</body>
</html>
